- name: assert preview result is error
  plugins:
    - processors:
      - control.error:
          message: expected error
        fatal: false
        logs: none
      - assert:
          error: /expected error/
    - processors:
      - control.error:
          message: expected error
        fatal: false
        logs: none
      - assert:
          error: /!/unexpected error/
    - processors:
      - control.error:
          message: expected error
        fatal: false
        logs: none
      - assert:
          error: expected error

- name: assert mime type match
  plugins:
    - processors:
      - inject.content:
          content: foo
          mime: application/octet-stream
      - assert:
          mime: application/octet-stream

- name: assert selected inner html match content
  plugins:
    - processors:
      - inject.content:
          content: <span class="test">hello world</span>
      - assert:
          html:
            select: .test
            match: hello world
      - assert:
          html:
            select: .test
            match: /hello world/
      - assert:
          html:
            select: .test
            match: /!/foo bar/

- name: assert selected raw html match content
  plugins:
    - processors:
      - inject.content:
          content: <span class="test" data-test="true"></span>
      - assert:
          html:
            select: .test
            match: /data-test="true"/
            raw: true
      - assert:
          html:
            select: html
            match: /<body>/
            raw: true

- name: assert selected html elements match count
  plugins:
    - processors:
      - inject.content:
          content: <span class="a"></span>
      - assert:
          html:
            select: .a
            count: 1=
      - assert:
          html:
            select: .a
            count: 0~1
      - assert:
          html:
            select: .a
            count: 1>=
      - assert:
          html:
            select: .a
            count: 0>
      - assert:
          html:
            select: .a
            count: 1<=
      - assert:
          html:
            select: .a
            count: 2<
      - assert:
          html:
            select: .b
            count: 0

- name: html selection cannot be used with non html-like mime type
  plugins:
    - processors:
      - inject.content:
          content: foo
          mime: application/octet-stream
      - assert:
          html:
            select: .foo
        fatal: false
        logs: none
      - assert:
          error: /is only supported for mime type/